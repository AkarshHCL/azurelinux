From dd3a911d790332d782896063fb0c85df4d1795c9 Mon Sep 17 00:00:00 2001
From: mbykhovtsev-ms <mbykhovtsev@microsoft.com>
Date: Fri, 10 Mar 2023 16:02:07 -0800
Subject: [PATCH] patching for CVE-2023-22742

---
 Cargo.lock                                           | 12 ++++++------
 src/tools/cargo/Cargo.toml                           |  6 +++---
 src/tools/cargo/crates/cargo-test-support/Cargo.toml |  2 +-
 vendor/git2/Cargo.toml                               |  2 +-
 vendor/libgit2-sys/Cargo.toml                        |  2 +-
 vendor/libgit2-sys/lib.rs                            |  2 +-
 6 files changed, 13 insertions(+), 13 deletions(-)

diff --git a/Cargo.lock b/Cargo.lock
index 51d937d4d..a2a501a10 100644
--- a/Cargo.lock
+++ b/Cargo.lock
@@ -1465,9 +1465,9 @@ dependencies = [
 
 [[package]]
 name = "git2"
-version = "0.13.23"
+version = "0.14.4"
 source = "registry+https://github.com/rust-lang/crates.io-index"
-checksum = "2a8057932925d3a9d9e4434ea016570d37420ddb1ceed45a174d577f24ed6700"
+checksum = "d0155506aab710a86160ddb504a480d2964d7ab5b9e62419be69e0032bc5931c"
 dependencies = [
  "bitflags",
  "libc",
@@ -1480,9 +1480,9 @@ dependencies = [
 
 [[package]]
 name = "git2-curl"
-version = "0.14.1"
+version = "0.15.0"
 source = "registry+https://github.com/rust-lang/crates.io-index"
-checksum = "883539cb0ea94bab3f8371a98cd8e937bbe9ee7c044499184aa4c17deb643a50"
+checksum = "1ee51709364c341fbb6fe2a385a290fb9196753bdde2fc45447d27cd31b11b13"
 dependencies = [
  "curl",
  "git2",
@@ -1929,9 +1929,9 @@ dependencies = [
 
 [[package]]
 name = "libgit2-sys"
-version = "0.12.24+1.3.0"
+version = "0.13.5+1.4.5"
 source = "registry+https://github.com/rust-lang/crates.io-index"
-checksum = "ddbd6021eef06fb289a8f54b3c2acfdd85ff2a585dfbb24b8576325373d2152c"
+checksum = "51e5ea06c26926f1002dd553fded6cfcdc9784c1f60feeb58368b4d9b07b6dba"
 dependencies = [
  "cc",
  "libc",
diff --git a/src/tools/cargo/Cargo.toml b/src/tools/cargo/Cargo.toml
index 20dfd540f..fce7c5b28 100644
--- a/src/tools/cargo/Cargo.toml
+++ b/src/tools/cargo/Cargo.toml
@@ -29,8 +29,8 @@ pretty_env_logger = { version = "0.4", optional = true }
 anyhow = "1.0"
 filetime = "0.2.9"
 flate2 = { version = "1.0.3", default-features = false, features = ["zlib"] }
-git2 = "0.13.23"
-git2-curl = "0.14.1"
+git2 = "0.14.4"
+git2-curl = "0.15.0"
 glob = "0.3.0"
 hex = "0.4"
 home = "0.5"
@@ -41,7 +41,7 @@ jobserver = "0.1.24"
 lazycell = "1.2.0"
 libc = "0.2"
 log = "0.4.6"
-libgit2-sys = "0.12.24"
+libgit2-sys = "0.13.5+1.4.5"
 memchr = "2.1.3"
 num_cpus = "1.0"
 opener = "0.5"
diff --git a/src/tools/cargo/crates/cargo-test-support/Cargo.toml b/src/tools/cargo/crates/cargo-test-support/Cargo.toml
index 7d57d9f02..3f43c0c30 100644
--- a/src/tools/cargo/crates/cargo-test-support/Cargo.toml
+++ b/src/tools/cargo/crates/cargo-test-support/Cargo.toml
@@ -13,7 +13,7 @@ cargo-test-macro = { path = "../cargo-test-macro" }
 cargo-util = { path = "../cargo-util" }
 filetime = "0.2"
 flate2 = { version = "1.0", default-features = false, features = ["zlib"] }
-git2 = "0.13.16"
+git2 = "0.14.4"
 glob = "0.3"
 itertools = "0.10.0"
 lazy_static = "1.0"
diff --git a/vendor/git2/Cargo.toml b/vendor/git2/Cargo.toml
index 299b77a8d..7d72d2cfb 100644
--- a/vendor/git2/Cargo.toml
+++ b/vendor/git2/Cargo.toml
@@ -28,7 +28,7 @@ version = "1.1.0"
 version = "0.2"
 
 [dependencies.libgit2-sys]
-version = "0.12.24"
+version = "0.13.5+1.4.5"
 
 [dependencies.log]
 version = "0.4.8"
diff --git a/vendor/libgit2-sys/Cargo.toml b/vendor/libgit2-sys/Cargo.toml
index dbf4f3844..8bd774521 100644
--- a/vendor/libgit2-sys/Cargo.toml
+++ b/vendor/libgit2-sys/Cargo.toml
@@ -12,7 +12,7 @@
 [package]
 edition = "2018"
 name = "libgit2-sys"
-version = "0.12.24+1.3.0"
+version = "0.13.5+1.4.5"
 authors = ["Josh Triplett <josh@joshtriplett.org>", "Alex Crichton <alex@alexcrichton.com>"]
 build = "build.rs"
 links = "git2"
diff --git a/vendor/libgit2-sys/lib.rs b/vendor/libgit2-sys/lib.rs
index 5e277b31e..f1a534179 100644
--- a/vendor/libgit2-sys/lib.rs
+++ b/vendor/libgit2-sys/lib.rs
@@ -1,4 +1,4 @@
-#![doc(html_root_url = "https://docs.rs/libgit2-sys/0.12")]
+#![doc(html_root_url = "https://docs.rs/libgit2-sys/0.13")]
 #![allow(non_camel_case_types, unused_extern_crates)]
 
 // This is required to link libz when libssh2-sys is not included.
-- 
2.25.1

