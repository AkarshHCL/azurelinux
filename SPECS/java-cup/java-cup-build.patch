From 9f6100cf9f58d1244e054a46d68ca85cf74b28a7 Mon Sep 17 00:00:00 2001
From: mbykhovtsev-ms <mbykhovtsev@microsoft.com>
Date: Wed, 16 Aug 2023 13:58:10 -0700
Subject: [PATCH] patch build

---
 build.xml | 30 +++++++-----------------------
 1 file changed, 7 insertions(+), 23 deletions(-)

diff --git a/build.xml b/build.xml
index db2f330..705f4c5 100644
--- a/build.xml
+++ b/build.xml
@@ -18,28 +18,6 @@
     <mkdir dir="${java}" />
     <mkdir dir="${classes}" />
     <mkdir dir="${dist}" />
-    <loadfile property="cupversion" srcFile="version.txt" failonerror="false" />
-    <property name="cupversion" value="custombuild" unless:set="cupversion"/>
-    <exec executable="git" outputproperty="gitversion">
-      <arg value="log"/>
-      <arg value="-1"/>
-      <arg value="--format=%h"/>
-    </exec>
-    <exec executable="git" outputproperty="changed">
-      <arg value="status"/>
-      <arg value="--porcelain"/>
-      <redirector>
-	<outputfilterchain>
-	<linecontainsregexp>
-	  <regexp pattern='^M.*'/>
-	</linecontainsregexp>
-	<tokenfilter>
-	  <replaceregex pattern=".*" replace="modifications based on "/>
-	</tokenfilter>
-	</outputfilterchain>
-	</redirector>
-    </exec>
-    <property name="svnversion">${changed}${gitversion}</property>
   </target>
 
   <property environment="env" />
@@ -91,7 +69,6 @@
    <jar jarfile="${dist}/java-cup-11b.jar" basedir="${classes}">
       <manifest>
         <attribute name="Main-Class" value="java_cup/Main" />
-	<attribute name="Class-Path" value="java-cup-11b-runtime.jar" />
       </manifest>
     </jar>
     <jar jarfile="${dist}/java-cup-11b-runtime.jar" basedir="${classes}" includes="java_cup/runtime/**">
@@ -145,4 +122,11 @@
     <echo message="  scp            to deploy relase to homepage" />
     <echo message="  versionbump    to inc release" />
   </target>
+
+  <target name="javadoc">
+    <mkdir dir="${dist}/javadoc"/>
+    <javadoc destdir="${dist}/javadoc" author="true" version="true" use="true" windowtitle="java_cup API">
+      <fileset dir="src" defaultexcludes="yes" />
+    </javadoc>
+  </target>
 </project>
-- 
2.25.1

